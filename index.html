<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Three.js 360Â° Panorama KTX2 Viewer</title>

  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.157.0/build/three.module.js",
      "PointerLockControls": "https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/controls/PointerLockControls.js",
      "KTX2Loader": "https://cdn.jsdelivr.net/npm/three@0.157.0/examples/jsm/loaders/KTX2Loader.js",
			"jszip":       "https://esm.sh/jszip@3.10.1"
    }
  }
  </script>

  <style>
    body { margin: 0; overflow: hidden; }
    canvas { display: block; }
  </style>
</head>
<body>
  <div id="overlay">Click to enter panorama viewer</div>

  <script type="module">
	
		// AUDIO
		const audioBuffers = [];

		async function loadAudioBuffer(url) {
			const response = await fetch(url);
			const arrayBuffer = await response.arrayBuffer();
			return await context.decodeAudioData(arrayBuffer);
		}

		async function preloadAllSounds() {
			for (let i = 0; i < node_arr.length; i++) {
				const buffer = await loadAudioBuffer(`sounds/${i}.wav`);
				audioBuffers[i] = buffer;
			}
		}
		
		let lastAudio = { start:0.0, offset:0.0 };
		
		function playNodeSound(index, sound_frame_number) {
			const buffer = audioBuffers[index];
			if (!buffer) return;

			const src = context.createBufferSource();
			src.buffer = buffer;

			const gainNode = context.createGain();
			const now = context.currentTime;

			const sliceDuration = 0.3;
			const fadeInTime = 0.15;
			const fadeOutTime = 0.15;

			const offset = sound_frame_number / 30.0 + (now - lastAudio.start - 1/30.0);

			// Schedule gain changes
			gainNode.gain.setValueAtTime(0, now);
			gainNode.gain.linearRampToValueAtTime(1, now + fadeInTime);
			gainNode.gain.setValueAtTime(1, now + sliceDuration - fadeOutTime);
			gainNode.gain.linearRampToValueAtTime(0, now + sliceDuration);

			src.connect(gainNode);
			gainNode.connect(context.destination);

			if (offset < (sound_frame_number + 1) / 30.0) src.start(now, offset, sliceDuration);

			lastAudio.start = now;
			lastAudio.offset = offset;
		}

		
		
		
	
		const node_arr = 	[
								[-0.000001, -8.000000, [1], 0],
								[-0.000001, -7.889648, [0, 2], 1],
								[-0.000001, -7.779296, [1, 3], 2],
								[-0.000001, -7.668944, [2, 4], 3],
								[-0.000001, -7.558592, [3, 5], 4],
								[-0.000001, -7.448241, [4, 6], 5],
								[-0.000000, -7.337889, [5, 7], 6],
								[-0.000000, -7.227537, [6, 8], 7],
								[-0.000000, -7.117185, [7, 9], 8],
								[-0.000000, -7.006833, [8, 10], 9],
								[-0.000000, -6.896481, [9, 11], 10],
								[-0.000000, -6.786129, [10, 12], 11],
								[-0.000000, -6.675777, [11, 13], 12],
								[-0.000000, -6.565425, [12, 14], 13],
								[-0.000000, -6.455073, [13, 15], 14],
								[-0.000000, -6.344722, [14, 16], 15],
								[-0.000000, -6.234370, [15, 17], 16],
								[-0.000000, -6.124018, [16, 18], 17],
								[-0.000000, -6.013666, [17, 19], 18],
								[-0.000000, -5.903314, [18, 20], 19],
								[-0.000000, -5.792962, [19, 21], 20],
								[-0.000000, -5.682611, [20, 22], 21],
								[-0.000000, -5.572258, [21, 23], 22],
								[-0.000000, -5.461906, [22, 24], 23],
								[-0.000000, -5.351555, [23, 25], 24],
								[-0.000000, -5.241202, [24, 26], 25],
								[-0.000000, -5.130851, [25, 27], 26],
								[-0.000000, -5.020499, [26, 28], 27],
								[-0.000000, -4.910147, [27, 29], 28],
								[-0.000000, -4.799795, [28, 30], 29],
								[-0.000000, -4.689444, [29, 31], 30],
								[-0.000000, -4.579092, [30, 32], 31],
								[-0.000000, -4.468740, [31, 33], 32],
								[-0.000000, -4.358387, [32, 34], 33],
								[-0.000000, -4.248035, [33, 35], 34],
								[-0.000000, -4.137684, [34, 36], 35],
								[-0.000000, -4.027332, [35, 37], 36],
								[-0.000000, -3.916980, [36, 38], 37],
								[-0.000000, -3.806628, [37, 39], 38],
								[-0.000000, -3.696277, [38, 40], 39],
								[-0.000000, -3.585925, [39, 41], 40],
								[-0.000000, -3.475573, [40, 42], 41],
								[-0.000000, -3.365221, [41, 43], 42],
								[-0.000000, -3.254869, [42, 44], 43],
								[-0.000000, -3.144517, [43, 45], 44],
								[-0.000000, -3.034165, [44, 46], 45],
								[-0.000000, -2.923814, [45, 47], 46],
								[-0.000000, -2.813461, [46, 48], 47],
								[-0.000000, -2.703110, [47, 49], 48],
								[-0.000000, -2.592757, [48, 50], 49],
								[-0.000000, -2.482405, [49, 51], 50],
								[-0.000000, -2.372054, [50, 52], 51],
								[-0.000000, -2.261702, [51, 53], 52],
								[-0.000000, -2.151350, [52, 54], 53],
								[-0.000000, -2.040998, [53, 55], 54],
								[-0.000000, -1.930646, [54, 56], 55],
								[-0.000000, -1.820294, [55, 57], 56],
								[-0.000000, -1.709942, [56, 58], 57],
								[-0.000000, -1.599591, [57, 59], 58],
								[-0.000000, -1.489238, [58, 60], 59],
								[-0.000000, -1.378887, [59, 61], 60],
								[-0.000000, -1.268535, [60, 62], 61],
								[-0.000000, -1.158183, [61, 63], 62],
								[-0.000000, -1.047831, [62, 64], 63],
								[-0.000000, -0.937479, [63, 65], 64],
								[-0.000000, -0.827127, [64, 66], 65],
								[-0.000000, -0.716775, [65, 67], 66],
								[-0.000000, -0.606423, [66, 68], 67],
								[-0.000000, -0.496072, [67, 69], 68],
								[-0.000000, -0.385720, [68, 70], 69],
								[-0.000000, -0.275368, [69, 71], 70],
								[-0.000000, -0.165015, [70, 72], 71],
								[-0.000000, -0.054664, [71, 73], 72],
								[-0.000000, 0.055689, [72, 74], 73],
								[-0.000000, 0.166040, [73, 75], 74],
								[-0.000000, 0.276392, [74, 76], 75],
								[-0.000000, 0.386744, [75, 77], 76],
								[-0.000000, 0.497096, [76, 78], 77],
								[-0.000000, 0.607447, [77, 79], 78],
								[-0.000000, 0.717800, [78, 80], 79],
								[-0.000000, 0.828151, [79, 81], 80],
								[-0.000000, 0.938503, [80, 82], 81],
								[-0.000000, 1.048855, [81, 83], 82],
								[-0.000000, 1.159206, [82, 84], 83],
								[-0.000000, 1.269559, [83, 85], 84],
								[-0.000000, 1.379910, [84, 86], 85],
								[-0.000000, 1.490263, [85, 87], 86],
								[-0.000000, 1.600615, [86, 88], 87],
								[-0.000000, 1.710966, [87, 89], 88],
								[-0.000000, 1.821318, [88, 90], 89],
								[-0.000000, 1.931670, [89, 91, 501], 90],


								[0.038976, 1.951051, [90, 92], 91],
								[0.077873, 1.970597, [91, 93], 92],
								[0.116707, 1.990259, [92, 94], 93],
								[0.155491, 2.010024, [93, 95], 94],
								[0.194230, 2.029877, [94, 96], 95],
								[0.232923, 2.049822, [95, 97], 96],
								[0.271574, 2.069841, [96, 98], 97],
								[0.310187, 2.089940, [97, 99], 98],
								[0.348756, 2.110119, [98, 100], 99],
								[0.387288, 2.130371, [99, 101], 100],
								[0.425781, 2.150694, [100, 102], 101],
								[0.464237, 2.171088, [101, 103], 102],
								[0.502656, 2.191553, [102, 104], 103],
								[0.541037, 2.212089, [103, 105], 104],
								[0.579381, 2.232694, [104, 106], 105],
								[0.617688, 2.253367, [105, 107], 106],
								[0.655958, 2.274109, [106, 108], 107],
								[0.694191, 2.294918, [107, 109], 108],
								[0.732387, 2.315796, [108, 110], 109],
								[0.770539, 2.336753, [109, 111], 110],
								[0.808654, 2.357779, [110, 112], 111],
								[0.846732, 2.378872, [111, 113], 112],
								[0.884773, 2.400031, [112, 114], 113],
								[0.922777, 2.421257, [113, 115], 114],
								[0.960738, 2.442559, [114, 116], 115],
								[0.998653, 2.463943, [115, 117], 116],
								[1.036531, 2.485393, [116, 118], 117],
								[1.074371, 2.506908, [117, 119], 118],
								[1.112171, 2.528495, [118, 120], 119],
								[1.149917, 2.550175, [119, 121], 120],
								[1.187624, 2.571922, [120, 122], 121],
								[1.225292, 2.593738, [121, 123], 122],
								[1.262918, 2.615630, [122, 124], 123],
								[1.300484, 2.637619, [123, 125], 124],
								[1.338012, 2.659676, [124, 126], 125],
								[1.375500, 2.681800, [125, 127], 126],
								[1.412928, 2.704027, [126, 128], 127],
								[1.450307, 2.726336, [127, 129], 128],
								[1.487642, 2.748712, [128, 130], 129],
								[1.524926, 2.771178, [129, 131], 130],
								[1.562148, 2.793751, [130, 132], 131],
								[1.599325, 2.816394, [131, 133], 132],
								[1.636455, 2.839114, [132, 134], 133],
								[1.673506, 2.861961, [133, 135], 134],
								[1.710512, 2.884885, [134, 136], 135],
								[1.747471, 2.907881, [135, 137], 136],
								[1.784345, 2.931015, [136, 138], 137],
								[1.821167, 2.954233, [137, 139], 138],
								[1.857938, 2.977528, [138, 140], 139],
								[1.894623, 3.000958, [139, 141], 140],
								[1.931245, 3.024488, [140, 142], 141],
								[1.967813, 3.048102, [141, 143], 142],
								[2.004293, 3.071852, [142, 144], 143],
								[2.040697, 3.095716, [143, 145], 144],
								[2.077043, 3.119670, [144, 146], 145],
								[2.113299, 3.143761, [145, 147], 146],
								[2.149465, 3.167984, [146, 148], 147],
								[2.185566, 3.192306, [147, 149], 148],
								[2.221576, 3.216761, [148, 150], 149],
								[2.257481, 3.241374, [149, 151], 150],
								[2.293311, 3.266092, [150, 152], 151],
								[2.329050, 3.290940, [151, 153], 152],
								[2.364661, 3.315975, [152, 154], 153],
								[2.400188, 3.341128, [153, 155], 154],
								[2.435630, 3.366402, [154, 156], 155],
								[2.470911, 3.391899, [155, 157], 156],
								[2.506094, 3.417528, [156, 158], 157],
								[2.541179, 3.443294, [157, 159], 158],
								[2.576111, 3.469267, [158, 160], 159],
								[2.610905, 3.495424, [159, 161], 160],
								[2.645582, 3.521736, [160, 162], 161],
								[2.680123, 3.548225, [161, 163], 162],
								[2.714467, 3.574971, [162, 164], 163],
								[2.748672, 3.601892, [163, 165], 164],
								[2.782730, 3.628999, [164, 166], 165],
								[2.816594, 3.656351, [165, 167], 166],
								[2.850246, 3.683962, [166, 168], 167],
								[2.883720, 3.711786, [167, 169], 168],
								[2.917008, 3.739837, [168, 170], 169],
								[2.950053, 3.768169, [169, 171], 170],
								[2.982830, 3.796814, [170, 172], 171],
								[3.015373, 3.825724, [171, 173], 172],
								[3.047664, 3.854915, [172, 174], 173],
								[3.079684, 3.884403, [173, 175], 174],
								[3.111347, 3.914273, [174, 176], 175],
								[3.142662, 3.944508, [175, 177], 176],
								[3.173629, 3.975100, [176, 178], 177],
								[3.204215, 4.006069, [177, 179], 178],
								[3.234385, 4.037445, [178, 180], 179],
								[3.264097, 4.069255, [179, 181], 180],
								[3.293308, 4.101529, [180, 182], 181],
								[3.321928, 4.134329, [181, 183], 182],
								[3.349906, 4.167674, [182, 184], 183],
								[3.377202, 4.201582, [183, 185], 184],
								[3.403733, 4.236091, [184, 186], 185],
								[3.429405, 4.271240, [185, 187], 186],
								[3.454111, 4.307077, [186, 188], 187],
								[3.477723, 4.343643, [187, 189], 188],
								[3.500042, 4.381014, [188, 190], 189],
								[3.520828, 4.419256, [189, 191], 190],
								[3.539927, 4.458363, [190, 192], 191],
								[3.557093, 4.498354, [191, 193], 192],
								[3.572047, 4.539223, [192, 194], 193],
								[3.584228, 4.580998, [193, 195], 194],
								[3.593114, 4.623592, [194, 196], 195],
								[3.598613, 4.666753, [195, 197], 196],
								[3.600000, 4.710248, [196, 198], 197],
								[3.600000, 4.753777, [197, 199], 198],
								[3.600000, 4.797306, [198, 200], 199],
								[3.600000, 4.840836, [199, 201], 200],
								[3.600000, 4.884366, [200, 202], 201],
								[3.600000, 4.927896, [201, 203], 202],
								[3.600000, 4.971424, [202, 204], 203],
								[3.600000, 5.014955, [203, 205], 204],
								[3.600000, 5.058485, [204, 206], 205],
								[3.600000, 5.102015, [205, 207], 206],
								[3.600000, 5.145543, [206, 208], 207],
								[3.600000, 5.189073, [207, 209], 208],
								[3.600000, 5.232603, [208, 210], 209],
								[3.600000, 5.276133, [209, 211], 210],
								[3.600000, 5.319661, [210, 212], 211],
								[3.600000, 5.363191, [211, 213], 212],
								[3.600000, 5.406721, [212, 214], 213],
								[3.600000, 5.450252, [213, 215], 214],
								[3.600000, 5.493781, [214, 216], 215],
								[3.600000, 5.537310, [215, 217], 216],
								[3.600000, 5.580840, [216, 218], 217],
								[3.600000, 5.624371, [217, 219], 218],
								[3.600000, 5.667899, [218, 220], 219],
								[3.600000, 5.711430, [219, 221], 220],
								[3.600000, 5.754958, [220, 222], 221],
								[3.600000, 5.798489, [221, 223], 222],
								[3.600000, 5.842018, [222, 224], 223],
								[3.600000, 5.885546, [223, 225], 224],
								[3.600000, 5.929079, [224, 226], 225],
								[3.601035, 5.972588, [225, 227], 226],
								[3.605105, 6.015913, [226, 228], 227],
								[3.611810, 6.058914, [227, 229], 228],
								[3.621432, 6.101357, [228, 230], 229],
								[3.633321, 6.143223, [229, 231], 230],
								[3.647284, 6.184445, [230, 232], 231],
								[3.663393, 6.224880, [231, 233], 232],
								[3.681139, 6.264622, [232, 234], 233],
								[3.700374, 6.303666, [233, 235], 234],
								[3.721011, 6.341989, [234, 236], 235],
								[3.742974, 6.379571, [235, 237], 236],
								[3.766011, 6.416500, [236, 238], 237],
								[3.790025, 6.452805, [237, 239], 238],
								[3.814925, 6.488505, [238, 240], 239],
								[3.840631, 6.523631, [239, 241], 240],
								[3.867072, 6.558208, [240, 242], 241],
								[3.894183, 6.592264, [241, 243], 242],
								[3.921904, 6.625825, [242, 244], 243],
								[3.950185, 6.658916, [243, 245], 244],
								[3.978977, 6.691562, [244, 246], 245],
								[4.008238, 6.723788, [245, 247], 246],
								[4.037932, 6.755618, [246, 248], 247],
								[4.068024, 6.787071, [247, 249], 248],
								[4.098481, 6.818170, [248, 250], 249],
								[4.129278, 6.848932, [249, 251], 250],
								[4.160388, 6.879378, [250, 252], 251],
								[4.191789, 6.909525, [251, 253], 252],
								[4.223460, 6.939386, [252, 254], 253],
								[4.255381, 6.968980, [253, 255], 254],
								[4.287537, 6.998320, [254, 256], 255],
								[4.319910, 7.027418, [255, 257], 256],
								[4.352489, 7.056291, [256, 258], 257],
								[4.385256, 7.084945, [257, 259], 258],
								[4.418228, 7.113363, [258, 260], 259],
								[4.451369, 7.141584, [259, 261], 260],
								[4.484666, 7.169624, [260, 262], 261],
								[4.518107, 7.197488, [261, 263], 262],
								[4.551686, 7.225189, [262, 264], 263],
								[4.585392, 7.252733, [263, 265], 264],
								[4.619223, 7.280125, [264, 266], 265],
								[4.653189, 7.307346, [265, 267], 266],
								[4.687260, 7.334440, [266, 268], 267],
								[4.721429, 7.361410, [267, 269], 268],
								[4.755689, 7.388262, [268, 270], 269],
								[4.790037, 7.415002, [269, 271], 270],
								[4.824473, 7.441628, [270, 272], 271],
								[4.858999, 7.468138, [271, 273], 272],
								[4.893594, 7.494558, [272, 274], 273],
								[4.928253, 7.520893, [273, 275], 274],
								[4.962974, 7.547149, [274, 276], 275],
								[4.997751, 7.573328, [275, 277], 276],
								[5.032595, 7.599419, [276, 278], 277],
								[5.067486, 7.625446, [277, 279], 278],
								[5.102420, 7.651417, [278, 280], 279],
								[5.137394, 7.677336, [279, 281], 280],
								[5.172402, 7.703204, [280, 282], 281],
								[5.207452, 7.729020, [281, 283], 282],
								[5.242528, 7.754797, [282, 284], 283],
								[5.277629, 7.780541, [283, 285], 284],
								[5.312749, 7.806258, [284, 286], 285],
								[5.347888, 7.831953, [285, 287], 286],
								[5.383041, 7.857625, [286, 288], 287],
								[5.418203, 7.883286, [287, 289], 288],
								[5.453371, 7.908937, [288, 290], 289],
								[5.488540, 7.934589, [289, 291], 290],
								[5.523707, 7.960243, [290, 292], 291],
								[5.558868, 7.985904, [291, 293], 292],
								[5.594016, 8.011584, [292, 294], 293],
								[5.629148, 8.037286, [293, 295], 294],
								[5.664261, 8.063013, [294, 296], 295],
								[5.699350, 8.088774, [295, 297], 296],
								[5.734411, 8.114571, [296, 298], 297],
								[5.769440, 8.140412, [297, 299], 298],
								[5.804420, 8.166318, [298, 300], 299],
								[5.839359, 8.192285, [299, 301], 300],
								[5.874246, 8.218317, [300, 302], 301],
								[5.909076, 8.244426, [301, 303], 302],
								[5.943843, 8.270618, [302, 304], 303],
								[5.978541, 8.296903, [303, 305], 304],
								[6.013163, 8.323288, [304, 306], 305],
								[6.047697, 8.349791, [305, 307], 306],
								[6.082126, 8.376425, [306, 308], 307],
								[6.116449, 8.403196, [307, 309], 308],
								[6.150658, 8.430115, [308, 310], 309],
								[6.184740, 8.457193, [309, 311], 310],
								[6.218682, 8.484446, [310, 312], 311],
								[6.252471, 8.511890, [311, 313], 312],
								[6.286089, 8.539540, [312, 314], 313],
								[6.319521, 8.567417, [313, 315], 314],
								[6.352745, 8.595541, [314, 316], 315],
								[6.385742, 8.623932, [315, 317], 316],
								[6.418485, 8.652613, [316, 318], 317],
								[6.450946, 8.681613, [317, 319], 318],
								[6.483094, 8.710960, [318, 320], 319],
								[6.514894, 8.740686, [319, 321], 320],
								[6.546304, 8.770823, [320, 322], 321],
								[6.577222, 8.801462, [321, 323], 322],
								[6.607624, 8.832615, [322, 324], 323],
								[6.637447, 8.864322, [323, 325], 324],
								[6.666614, 8.896632, [324, 326], 325],
								[6.694958, 8.929667, [325, 327], 326],
								[6.722320, 8.963518, [326, 328], 327],
								[6.748644, 8.998182, [327, 329], 328],
								[6.774057, 9.033524, [328, 330], 329],
								[6.799125, 9.069111, [329, 331], 330],
								[6.823864, 9.104925, [330, 332], 331],
								[6.848279, 9.140965, [331, 333], 332],
								[6.872415, 9.177189, [332, 334], 333],
								[6.896253, 9.213612, [333, 335], 334],
								[6.919811, 9.250216, [334, 336], 335],
								[6.943118, 9.286978, [335, 337], 336],
								[6.966175, 9.323900, [336, 338], 337],
								[6.988957, 9.360992, [337, 339], 338],
								[7.011510, 9.398222, [338, 340], 339],
								[7.033836, 9.435591, [339, 341], 340],
								[7.055941, 9.473091, [340, 342], 341],
								[7.077798, 9.510735, [341, 343], 342],
								[7.099440, 9.548504, [342, 344], 343],
								[7.120871, 9.586391, [343, 345], 344],
								[7.142096, 9.624397, [344, 346], 345],
								[7.163116, 9.662514, [345, 347], 346],
								[7.183926, 9.700748, [346, 348], 347],
								[7.204522, 9.739098, [347, 349], 348],
								[7.224919, 9.777550, [348, 350], 349],
								[7.245121, 9.816109, [349, 351], 350],
								[7.265130, 9.854767, [350, 352], 351],
								[7.284944, 9.893526, [351, 353], 352],
								[7.304566, 9.932383, [352, 354], 353],
								[7.323996, 9.971334, [353, 355], 354],
								[7.343221, 10.010389, [354, 356], 355],
								[7.362252, 10.049538, [355, 357], 356],
								[7.381091, 10.088779, [356, 358], 357],
								[7.399740, 10.128113, [357, 359], 358],
								[7.418197, 10.167534, [358, 360], 359],
								[7.436464, 10.207047, [359, 361], 360],
								[7.454536, 10.246647, [360, 362], 361],
								[7.472415, 10.286335, [361, 363], 362],
								[7.490101, 10.326109, [362, 364], 363],
								[7.507590, 10.365973, [363, 365], 364],
								[7.524880, 10.405920, [364, 366], 365],
								[7.541957, 10.445959, [365, 367], 366],
								[7.558836, 10.486084, [366, 368], 367],
								[7.575511, 10.526295, [367, 369], 368],
								[7.591980, 10.566587, [368, 370], 369],
								[7.608241, 10.606964, [369, 371], 370],
								[7.624291, 10.647427, [370, 372], 371],
								[7.640129, 10.687973, [371, 373], 372],
								[7.655750, 10.728603, [372, 374], 373],
								[7.671152, 10.769318, [373, 375], 374],
								[7.686329, 10.810114, [374, 376], 375],
								[7.701280, 10.850996, [375, 377], 376],
								[7.715999, 10.891962, [376, 378], 377],
								[7.730464, 10.933018, [377, 379], 378],
								[7.744688, 10.974159, [378, 380], 379],
								[7.758666, 11.015381, [379, 381], 380],
								[7.772392, 11.056690, [380, 382], 381],
								[7.785861, 11.098083, [381, 383], 382],
								[7.799066, 11.139561, [382, 384], 383],
								[7.812002, 11.181126, [383, 385], 384],
								[7.824661, 11.222773, [384, 386], 385],
								[7.837037, 11.264505, [385, 387], 386],
								[7.849107, 11.306328, [386, 388], 387],
								[7.860861, 11.348242, [387, 389], 388],
								[7.872305, 11.390238, [388, 390], 389],
								[7.883430, 11.432323, [389, 391], 390],
								[7.894227, 11.474491, [390, 392], 391],
								[7.904685, 11.516747, [391, 393], 392],
								[7.914793, 11.559086, [392, 394], 393],
								[7.924507, 11.601517, [393, 395], 394],
								[7.933829, 11.644037, [394, 396], 395],
								[7.942760, 11.686642, [395, 397], 396],
								[7.951287, 11.729328, [396, 398], 397],
								[7.959394, 11.772093, [397, 399], 398],
								[7.967030, 11.814949, [398, 400], 399],
								[7.974175, 11.857887, [399, 401], 400],
								[7.980844, 11.900904, [400, 402], 401],
								[7.987018, 11.943991, [401, 403], 402],
								[7.992637, 11.987156, [402, 404], 403],
								[7.997656, 12.030396, [403, 405], 404],
								[8.002106, 12.073696, [404, 406], 405],
								[8.005957, 12.117054, [405, 407], 406],
								[8.009062, 12.160471, [406, 408], 407],
								[8.011505, 12.203934, [407, 409], 408],
								[8.013235, 12.247427, [408, 410], 409],
								[8.014097, 12.290947, [409, 411], 410],
								[8.014183, 12.334476, [410, 412], 411],
								[8.013334, 12.377995, [411, 413], 412],
								[8.011435, 12.421482, [412, 414], 413],
								[8.008112, 12.464882, [413, 415], 414],
								[8.003275, 12.508139, [414, 416], 415],
								[7.997250, 12.551247, [415, 417], 416],
								[7.990037, 12.594173, [416, 418], 417],
								[7.981737, 12.636902, [417, 419], 418],
								[7.972529, 12.679447, [418, 420], 419],
								[7.962481, 12.721798, [419, 421], 420],
								[7.951606, 12.763947, [420, 422], 421],
								[7.939968, 12.805889, [421, 423], 422],
								[7.927672, 12.847647, [422, 424], 423],
								[7.914763, 12.889217, [423, 425], 424],
								[7.901281, 12.930605, [424, 426], 425],
								[7.887261, 12.971813, [425, 427], 426],
								[7.872739, 13.012852, [426, 428], 427],
								[7.857743, 13.053715, [427, 429], 428],
								[7.842286, 13.094408, [428, 430], 429],
								[7.826407, 13.134935, [429, 431], 430],
								[7.810137, 13.175312, [430, 432], 431],
								[7.793497, 13.215534, [431, 433], 432],
								[7.776506, 13.255613, [432, 434], 433],
								[7.759183, 13.295546, [433, 435], 434],
								[7.741543, 13.335340, [434, 436], 435],
								[7.723602, 13.375000, [435, 437], 436],
								[7.705373, 13.414530, [436, 438], 437],
								[7.686870, 13.453932, [437, 439], 438],
								[7.668105, 13.493208, [438, 440], 439],
								[7.649088, 13.532364, [439, 441], 440],
								[7.629831, 13.571404, [440, 442], 441],
								[7.610342, 13.610327, [441, 443], 442],
								[7.590631, 13.649137, [442, 444], 443],
								[7.570704, 13.687838, [443, 445], 444],
								[7.550561, 13.726425, [444, 446], 445],
								[7.530221, 13.764912, [445, 447], 446],
								[7.509689, 13.803295, [446, 448], 447],
								[7.488972, 13.841576, [447, 449], 448],
								[7.468075, 13.879763, [448, 450], 449],
								[7.447004, 13.917854, [449, 451], 450],
								[7.425765, 13.955849, [450, 452], 451],
								[7.404362, 13.993755, [451, 453], 452],
								[7.382801, 14.031567, [452, 454], 453],
								[7.361084, 14.069292, [453, 455], 454],
								[7.339216, 14.106932, [454, 456], 455],
								[7.317202, 14.144485, [455, 457], 456],
								[7.295044, 14.181952, [456, 458], 457],
								[7.272748, 14.219337, [457, 459], 458],
								[7.250313, 14.256639, [458, 460], 459],
								[7.227744, 14.293863, [459, 461], 460],
								[7.205041, 14.331003, [460, 462], 461],
								[7.182207, 14.368063, [461, 463], 462],
								[7.159245, 14.405045, [462, 464], 463],
								[7.136160, 14.441948, [463, 465], 464],
								[7.112955, 14.478779, [464, 466], 465],
								[7.089630, 14.515528, [465, 467], 466],
								[7.066187, 14.552206, [466, 468], 467],
								[7.042628, 14.588810, [467, 469], 468],
								[7.018954, 14.625340, [468, 470], 469],
								[6.995167, 14.661797, [469, 471], 470],
								[6.971268, 14.698175, [470, 472], 471],
								[6.947258, 14.734486, [471, 473], 472],
								[6.923136, 14.770721, [472, 474], 473],
								[6.898905, 14.806883, [473, 475], 474],
								[6.874567, 14.842972, [474, 476], 475],
								[6.850118, 14.878986, [475, 477], 476],
								[6.825562, 14.914930, [476, 478], 477],
								[6.800898, 14.950798, [477, 479], 478],
								[6.776125, 14.986591, [478, 480], 479],
								[6.751245, 15.022308, [479, 481], 480],
								[6.726251, 15.057947, [480, 482], 481],
								[6.701142, 15.093506, [481, 483], 482],
								[6.675923, 15.128986, [482, 484], 483],
								[6.650591, 15.164385, [483, 485], 484],
								[6.625146, 15.199703, [484, 486], 485],
								[6.599586, 15.234940, [485, 487], 486],
								[6.573902, 15.270082, [486, 488], 487],
								[6.548084, 15.305130, [487, 489], 488],
								[6.522142, 15.340084, [488, 490], 489],
								[6.496071, 15.374943, [489, 491], 490],
								[6.469841, 15.409683, [490, 492], 491],
								[6.443468, 15.444313, [491, 493], 492],
								[6.416927, 15.478817, [492, 494], 493],
								[6.390209, 15.513180, [493, 495], 494],
								[6.363286, 15.547386, [494, 496], 495],
								[6.336145, 15.581419, [495, 497], 496],
								[6.308739, 15.615238, [496, 498], 497],
								[6.281008, 15.648788, [497, 499], 498],
								[6.252851, 15.681984, [498, 500], 499],
								[6.224123, 15.714687, [499], 500],


								[-0.024460, 1.945837, [90, 502], 91],
								[-0.048876, 1.960078, [501, 503], 92],
								[-0.073261, 1.974374, [502, 504], 93],
								[-0.097620, 1.988709, [503, 505], 94],
								[-0.121957, 2.003085, [504, 506], 95],
								[-0.146272, 2.017500, [505, 507], 96],
								[-0.170566, 2.031947, [506, 508], 97],
								[-0.194842, 2.046426, [507, 509], 98],
								[-0.219100, 2.060936, [508, 510], 99],
								[-0.243337, 2.075479, [509, 511], 100],
								[-0.267557, 2.090052, [510, 512], 101],
								[-0.291759, 2.104651, [511, 513], 102],
								[-0.315946, 2.119277, [512, 514], 103],
								[-0.340120, 2.133928, [513, 515], 104],
								[-0.364270, 2.148615, [514, 516], 105],
								[-0.388406, 2.163325, [515, 517], 106],
								[-0.412530, 2.178056, [516, 518], 107],
								[-0.436633, 2.192821, [517, 519], 108],
								[-0.460721, 2.207610, [518, 520], 109],
								[-0.484798, 2.222417, [519, 521], 110],
								[-0.508850, 2.237262, [520, 522], 111],
								[-0.532893, 2.252127, [521, 523], 112],
								[-0.556921, 2.267014, [522, 524], 113],
								[-0.580927, 2.281935, [523, 525], 114],
								[-0.604927, 2.296868, [524, 526], 115],
								[-0.628900, 2.311842, [525, 527], 116],
								[-0.652865, 2.326830, [526, 528], 117],
								[-0.676811, 2.341849, [527, 529], 118],
								[-0.700742, 2.356892, [528, 530], 119],
								[-0.724658, 2.371957, [529, 531], 120],
								[-0.748555, 2.387053, [530, 532], 121],
								[-0.772442, 2.402166, [531, 533], 122],
								[-0.796304, 2.417316, [532, 534], 123],
								[-0.820160, 2.432476, [533, 535], 124],
								[-0.843989, 2.447679, [534, 536], 125],
								[-0.867814, 2.462889, [535, 537], 126],
								[-0.891610, 2.478146, [536, 538], 127],
								[-0.915402, 2.493407, [537, 539], 128],
								[-0.939163, 2.508715, [538, 540], 129],
								[-0.962922, 2.524028, [539, 541], 130],
								[-0.986651, 2.539388, [540, 542], 131],
								[-1.010375, 2.554754, [541, 543], 132],
								[-1.034069, 2.570167, [542, 544], 133],
								[-1.057757, 2.585587, [543, 545], 134],
								[-1.081419, 2.601050, [544, 546], 135],
								[-1.105071, 2.616528, [545, 547], 136],
								[-1.128698, 2.632041, [546, 548], 137],
								[-1.152313, 2.647577, [547, 549], 138],
								[-1.175908, 2.663140, [548, 550], 139],
								[-1.199482, 2.678735, [549, 551], 140],
								[-1.223044, 2.694349, [550, 552], 141],
								[-1.246580, 2.710005, [551, 553], 142],
								[-1.270108, 2.725668, [552, 554], 143],
								[-1.293600, 2.741386, [553, 555], 144],
								[-1.317092, 2.757104, [554, 556], 145],
								[-1.340546, 2.772882, [555, 557], 146],
								[-1.363994, 2.788664, [556, 558], 147],
								[-1.387413, 2.804492, [557, 559], 148],
								[-1.410818, 2.820341, [558, 560], 149],
								[-1.434203, 2.836219, [559, 561], 150],
								[-1.457560, 2.852137, [560, 562], 151],
								[-1.480911, 2.868064, [561, 563], 152],
								[-1.504220, 2.884053, [562, 564], 153],
								[-1.527530, 2.900041, [563, 565], 154],
								[-1.550797, 2.916092, [564, 566], 155],
								[-1.574057, 2.932153, [565, 567], 156],
								[-1.597288, 2.948254, [566, 568], 157],
								[-1.620496, 2.964390, [567, 569], 158],
								[-1.643691, 2.980544, [568, 570], 159],
								[-1.666845, 2.996756, [569, 571], 160],
								[-1.690000, 3.012969, [570, 572], 161],
								[-1.713102, 3.029254, [571, 573], 162],
								[-1.736200, 3.045546, [572, 574], 163],
								[-1.759265, 3.061885, [573, 575], 164],
								[-1.782304, 3.078259, [574, 576], 165],
								[-1.805330, 3.094653, [575, 577], 166],
								[-1.828310, 3.111112, [576, 578], 167],
								[-1.851290, 3.127571, [577, 579], 168],
								[-1.874214, 3.144108, [578, 580], 169],
								[-1.897130, 3.160654, [579, 581], 170],
								[-1.920012, 3.177248, [580, 582], 171],
								[-1.942864, 3.193885, [581, 583], 172],
								[-1.965703, 3.210537, [582, 584], 173],
								[-1.988486, 3.227268, [583, 585], 174],
								[-2.011268, 3.243998, [584, 586], 175],
								[-2.033993, 3.260807, [585, 587], 176],
								[-2.056705, 3.277635, [586, 588], 177],
								[-2.079383, 3.294507, [587, 589], 178],
								[-2.102019, 3.311434, [588, 590], 179],
								[-2.124648, 3.328372, [589, 591], 180],
								[-2.147207, 3.345402, [590, 592], 181],
								[-2.169766, 3.362433, [591, 593], 182],
								[-2.192264, 3.379543, [592, 594], 183],
								[-2.214741, 3.396681, [593, 595], 184],
								[-2.237186, 3.413864, [594, 596], 185],
								[-2.259579, 3.431114, [595, 597], 186],
								[-2.281966, 3.448369, [596, 598], 187],
								[-2.304269, 3.465734, [597, 599], 188],
								[-2.326572, 3.483099, [598, 600], 189],
								[-2.348807, 3.500551, [599, 601], 190],
								[-2.371016, 3.518035, [600, 602], 191],
								[-2.393186, 3.535569, [601, 603], 192],
								[-2.415297, 3.553179, [602, 604], 193],
								[-2.437399, 3.570799, [603, 605], 194],
								[-2.459405, 3.588537, [604, 606], 195],
								[-2.481413, 3.606275, [605, 607], 196],
								[-2.503335, 3.624119, [606, 608], 197],
								[-2.525233, 3.641992, [607, 609], 198],
								[-2.547074, 3.659934, [608, 610], 199],
								[-2.568857, 3.677946, [609, 611], 200],
								[-2.590613, 3.695992, [610, 612], 201],
								[-2.612275, 3.714150, [611, 613], 202],
								[-2.633936, 3.732308, [612, 614], 203],
								[-2.655474, 3.750613, [613, 615], 204],
								[-2.677009, 3.768923, [614, 616], 205],
								[-2.698442, 3.787349, [615, 617], 206],
								[-2.719841, 3.805816, [616, 618], 207],
								[-2.741165, 3.824371, [617, 619], 208],
								[-2.762421, 3.843003, [618, 620], 209],
								[-2.783626, 3.861692, [619, 621], 210],
								[-2.804729, 3.880496, [620, 622], 211],
								[-2.825806, 3.899329, [621, 623], 212],
								[-2.846750, 3.918314, [622, 624], 213],
								[-2.867689, 3.937301, [623, 625], 214],
								[-2.888459, 3.956472, [624, 626], 215],
								[-2.909230, 3.975643, [625, 627], 216],
								[-2.929837, 3.994991, [626, 628], 217],
								[-2.950424, 4.014358, [627, 629], 218],
								[-2.970855, 4.033891, [628, 630], 219],
								[-2.991248, 4.053464, [629, 631], 220],
								[-3.011486, 4.073196, [630, 632], 221],
								[-3.031670, 4.092984, [631, 633], 222],
								[-3.051696, 4.112931, [632, 634], 223],
								[-3.071656, 4.132943, [633, 635], 224],
								[-3.091449, 4.153124, [634, 636], 225],
								[-3.111170, 4.173372, [635, 637], 226],
								[-3.130702, 4.193804, [636, 638], 227],
								[-3.150167, 4.214300, [637, 639], 228],
								[-3.169409, 4.235004, [638, 640], 229],
								[-3.188597, 4.255760, [639, 641], 230],
								[-3.207514, 4.276762, [640, 642], 231],
								[-3.226390, 4.297801, [641, 643], 232],
								[-3.244957, 4.319115, [642, 644], 233],
								[-3.263447, 4.340492, [643, 645], 234],
								[-3.281664, 4.362105, [644, 646], 235],
								[-3.299718, 4.383853, [645, 647], 236],
								[-3.317554, 4.405780, [646, 648], 237],
								[-3.335110, 4.427933, [647, 649], 238],
								[-3.352533, 4.450190, [648, 650], 239],
								[-3.369517, 4.472783, [649, 651], 240],
								[-3.386339, 4.495497, [650, 652], 241],
								[-3.402818, 4.518462, [651, 653], 242],
								[-3.418930, 4.541684, [652, 654], 243],
								[-3.434810, 4.565067, [653, 655], 244],
								[-3.450156, 4.588804, [654, 656], 245],
								[-3.465137, 4.612771, [655, 657], 246],
								[-3.479784, 4.636944, [656, 658], 247],
								[-3.493757, 4.661515, [657, 659], 248],
								[-3.507244, 4.686352, [658, 660], 249],
								[-3.520243, 4.711448, [659, 661], 250],
								[-3.532540, 4.736899, [660, 662], 251],
								[-3.544022, 4.762724, [661, 663], 252],
								[-3.554790, 4.788852, [662, 664], 253],
								[-3.564754, 4.815298, [663, 665], 254],
								[-3.573798, 4.842079, [664, 666], 255],
								[-3.581532, 4.869265, [665, 667], 256],
								[-3.588102, 4.896750, [666, 668], 257],
								[-3.593363, 4.924511, [667, 669], 258],
								[-3.597157, 4.952507, [668, 670], 259],
								[-3.599316, 4.980674, [669, 671], 260],
								[-3.600000, 5.008929, [670, 672], 261],
								[-3.600000, 5.037194, [671, 673], 262],
								[-3.600000, 5.065461, [672, 674], 263],
								[-3.600000, 5.093727, [673, 675], 264],
								[-3.600000, 5.121992, [674, 676], 265],
								[-3.600000, 5.150258, [675, 677], 266],
								[-3.600000, 5.178524, [676, 678], 267],
								[-3.600000, 5.206789, [677, 679], 268],
								[-3.600000, 5.235055, [678, 680], 269],
								[-3.600000, 5.263321, [679, 681], 270],
								[-3.600000, 5.291587, [680, 682], 271],
								[-3.600000, 5.319853, [681, 683], 272],
								[-3.600000, 5.348119, [682, 684], 273],
								[-3.600000, 5.376385, [683, 685], 274],
								[-3.600000, 5.404650, [684, 686], 275],
								[-3.600000, 5.432916, [685, 687], 276],
								[-3.600000, 5.461182, [686, 688], 277],
								[-3.600000, 5.489448, [687, 689], 278],
								[-3.600000, 5.517714, [688, 690], 279],
								[-3.600000, 5.545980, [689, 691], 280],
								[-3.600000, 5.574245, [690, 692], 281],
								[-3.600000, 5.602512, [691, 693], 282],
								[-3.600000, 5.630777, [692, 694], 283],
								[-3.600000, 5.659044, [693, 695], 284],
								[-3.600000, 5.687309, [694, 696], 285],
								[-3.600000, 5.715575, [695, 697], 286],
								[-3.600000, 5.743841, [696, 698], 287],
								[-3.600000, 5.772107, [697, 699], 288],
								[-3.600000, 5.800373, [698, 700], 289],
								[-3.600000, 5.828639, [699, 701], 290],
								[-3.600000, 5.856904, [700, 702], 291],
								[-3.600000, 5.885170, [701, 703], 292],
								[-3.599999, 5.913436, [702, 704], 293],
								[-3.599999, 5.941702, [703, 705], 294],
								[-3.599999, 5.969967, [704, 706], 295],
								[-3.599999, 5.998234, [705, 707], 296],
								[-3.600000, 6.026499, [706, 708], 297],
								[-3.599999, 6.054766, [707, 709], 298],
								[-3.599999, 6.083031, [708, 710], 299],
								[-3.599999, 6.111297, [709, 711], 300],
								[-3.599999, 6.139563, [710, 712], 301],
								[-3.599999, 6.167829, [711, 713], 302],
								[-3.599999, 6.196095, [712, 714], 303],
								[-3.599999, 6.224360, [713, 715], 304],
								[-3.599999, 6.252626, [714, 716], 305],
								[-3.599999, 6.280892, [715, 717], 306],
								[-3.599999, 6.309158, [716, 718], 307],
								[-3.599999, 6.337424, [717, 719], 308],
								[-3.599999, 6.365690, [718, 720], 309],
								[-3.599999, 6.393956, [719, 721], 310],
								[-3.599999, 6.422222, [720, 722], 311],
								[-3.599999, 6.450488, [721, 723], 312],
								[-3.599999, 6.478753, [722, 724], 313],
								[-3.599999, 6.507020, [723, 725], 314],
								[-3.599999, 6.535285, [724, 726], 315],
								[-3.599999, 6.563551, [725, 727], 316],
								[-3.599999, 6.591816, [726, 728], 317],
								[-3.599999, 6.620083, [727, 729], 318],
								[-3.599999, 6.648348, [728, 730], 319],
								[-3.599999, 6.676614, [729, 731], 320],
								[-3.599999, 6.704880, [730, 732], 321],
								[-3.599999, 6.733146, [731, 733], 322],
								[-3.599999, 6.761412, [732, 734], 323],
								[-3.599999, 6.789678, [733, 735], 324],
								[-3.599999, 6.817944, [734, 736], 325],
								[-3.599999, 6.846209, [735, 737], 326],
								[-3.599999, 6.874475, [736, 738], 327],
								[-3.599999, 6.902741, [737, 739], 328],
								[-3.599999, 6.931007, [738, 740], 329],
								[-3.599999, 6.959273, [739, 741], 330],
								[-3.599999, 6.987539, [740, 742], 331],
								[-3.599999, 7.015805, [741, 743], 332],
								[-3.599999, 7.044070, [742, 744], 333],
								[-3.599999, 7.072336, [743, 745], 334],
								[-3.599999, 7.100602, [744, 746], 335],
								[-3.599999, 7.128868, [745, 747], 336],
								[-3.599999, 7.157134, [746, 748], 337],
								[-3.599999, 7.185400, [747, 749], 338],
								[-3.599999, 7.213666, [748, 750], 339],
								[-3.599999, 7.241932, [749, 751], 340],
								[-3.599999, 7.270198, [750, 752], 341],
								[-3.599999, 7.298463, [751, 753], 342],
								[-3.599999, 7.326730, [752, 754], 343],
								[-3.599999, 7.354995, [753, 755], 344],
								[-3.599999, 7.383260, [754, 756], 345],
								[-3.599999, 7.411526, [755, 757], 346],
								[-3.599999, 7.439793, [756, 758], 347],
								[-3.599999, 7.468058, [757, 759], 348],
								[-3.599999, 7.496324, [758, 760], 349],
								[-3.600000, 7.524590, [759, 761], 350],
								[-3.599999, 7.552856, [760, 762], 351],
								[-3.599999, 7.581121, [761, 763], 352],
								[-3.599999, 7.609387, [762, 764], 353],
								[-3.599999, 7.637653, [763, 765], 354],
								[-3.599999, 7.665919, [764, 766], 355],
								[-3.600000, 7.694186, [765, 767], 356],
								[-3.599999, 7.722451, [766, 768], 357],
								[-3.599999, 7.750717, [767, 769], 358],
								[-3.599999, 7.778983, [768, 770], 359],
								[-3.599999, 7.807249, [769, 771], 360],
								[-3.599999, 7.835515, [770, 772], 361],
								[-3.599999, 7.863780, [771, 773], 362],
								[-3.599999, 7.892045, [772, 774], 363],
								[-3.599999, 7.920312, [773, 775], 364],
								[-3.599999, 7.948578, [774, 776], 365],
								[-3.599999, 7.976843, [775, 777], 366],
								[-3.599999, 8.005109, [776, 778], 367],
								[-3.599999, 8.033375, [777, 779], 368],
								[-3.599999, 8.061641, [778, 780], 369],
								[-3.599999, 8.089908, [779, 781], 370],
								[-3.599999, 8.118173, [780, 782], 371],
								[-3.599999, 8.146439, [781, 783], 372],
								[-3.600000, 8.174705, [782, 784], 373],
								[-3.599999, 8.202971, [783, 785], 374],
								[-3.599999, 8.231236, [784, 786], 375],
								[-3.599999, 8.259501, [785, 787], 376],
								[-3.599999, 8.287767, [786, 788], 377],
								[-3.599999, 8.316034, [787, 789], 378],
								[-3.599999, 8.344300, [788, 790], 379],
								[-3.599999, 8.372565, [789, 791], 380],
								[-3.599999, 8.400831, [790, 792], 381],
								[-3.599999, 8.429097, [791, 793], 382],
								[-3.599999, 8.457363, [792, 794], 383],
								[-3.599999, 8.485629, [793, 795], 384],
								[-3.599999, 8.513894, [794, 796], 385],
								[-3.599999, 8.542160, [795, 797], 386],
								[-3.599999, 8.570427, [796, 798], 387],
								[-3.599999, 8.598693, [797, 799], 388],
								[-3.599999, 8.626957, [798, 800], 389],
								[-3.599999, 8.655224, [799, 801], 390],
								[-3.599999, 8.683490, [800, 802], 391],
								[-3.599999, 8.711756, [801, 803], 392],
								[-3.599999, 8.740021, [802, 804], 393],
								[-3.599999, 8.768287, [803, 805], 394],
								[-3.599999, 8.796554, [804, 806], 395],
								[-3.599999, 8.824820, [805, 807], 396],
								[-3.599999, 8.853086, [806, 808], 397],
								[-3.599999, 8.881350, [807, 809], 398],
								[-3.599999, 8.909616, [808, 810], 399],
								[-3.599999, 8.937882, [809, 811], 400],
								[-3.599999, 8.966148, [810, 812], 401],
								[-3.599999, 8.994414, [811, 813], 402],
								[-3.599999, 9.022679, [812, 814], 403],
								[-3.599999, 9.050946, [813, 815], 404],
								[-3.599999, 9.079212, [814, 816], 405],
								[-3.599999, 9.107478, [815, 817], 406],
								[-3.599999, 9.135743, [816, 818], 407],
								[-3.599999, 9.164009, [817, 819], 408],
								[-3.599999, 9.192275, [818, 820], 409],
								[-3.599999, 9.220542, [819, 821], 410],
								[-3.599999, 9.248807, [820, 822], 411],
								[-3.599999, 9.277072, [821, 823], 412],
								[-3.599999, 9.305339, [822, 824], 413],
								[-3.599999, 9.333604, [823, 825], 414],
								[-3.599999, 9.361871, [824, 826], 415],
								[-3.599999, 9.390136, [825, 827], 416],
								[-3.599999, 9.418402, [826, 828], 417],
								[-3.599999, 9.446668, [827, 829], 418],
								[-3.599999, 9.474934, [828, 830], 419],
								[-3.599999, 9.503201, [829, 831], 420],
								[-3.599999, 9.531465, [830, 832], 421],
								[-3.600000, 9.559731, [831, 833], 422],
								[-3.599999, 9.587997, [832, 834], 423],
								[-3.599999, 9.616263, [833, 835], 424],
								[-3.599999, 9.644528, [834, 836], 425],
								[-3.599999, 9.672794, [835, 837], 426],
								[-3.599999, 9.701061, [836, 838], 427],
								[-3.599999, 9.729326, [837, 839], 428],
								[-3.599999, 9.757592, [838, 840], 429],
								[-3.599999, 9.785858, [839, 841], 430],
								[-3.599999, 9.814124, [840, 842], 431],
								[-3.599999, 9.842390, [841, 843], 432],
								[-3.599999, 9.870656, [842, 844], 433],
								[-3.599999, 9.898921, [843, 845], 434],
								[-3.599999, 9.927187, [844, 846], 435],
								[-3.599999, 9.955453, [845, 847], 436],
								[-3.599999, 9.983720, [846, 848], 437],
								[-3.599999, 10.011985, [847, 849], 438],
								[-3.599999, 10.040251, [848, 850], 439],
								[-3.599999, 10.068517, [849, 851], 440],
								[-3.599999, 10.096783, [850, 852], 441],
								[-3.599999, 10.125049, [851, 853], 442],
								[-3.599999, 10.153315, [852, 854], 443],
								[-3.599999, 10.181581, [853, 855], 444],
								[-3.599999, 10.209846, [854, 856], 445],
								[-3.599999, 10.238112, [855, 857], 446],
								[-3.599999, 10.266378, [856, 858], 447],
								[-3.599999, 10.294643, [857, 859], 448],
								[-3.600000, 10.322909, [858, 860], 449],
								[-3.599999, 10.351174, [859, 861], 450],
								[-3.599999, 10.379441, [860, 862], 451],
								[-3.599999, 10.407707, [861, 863], 452],
								[-3.599999, 10.435973, [862, 864], 453],
								[-3.599999, 10.464239, [863, 865], 454],
								[-3.599999, 10.492505, [864, 866], 455],
								[-3.599999, 10.520770, [865, 867], 456],
								[-3.599999, 10.549036, [866, 868], 457],
								[-3.599999, 10.577302, [867, 869], 458],
								[-3.599999, 10.605568, [868, 870], 459],
								[-3.599999, 10.633835, [869, 871], 460],
								[-3.599999, 10.662101, [870, 872], 461],
								[-3.599999, 10.690366, [871, 873], 462],
								[-3.599999, 10.718631, [872, 874], 463],
								[-3.600000, 10.746898, [873, 875], 464],
								[-3.599999, 10.775164, [874, 876], 465],
								[-3.599999, 10.803429, [875, 877], 466],
								[-3.599999, 10.831695, [876, 878], 467],
								[-3.599999, 10.859961, [877, 879], 468],
								[-3.599999, 10.888227, [878, 880], 469],
								[-3.599999, 10.916493, [879, 881], 470],
								[-3.599999, 10.944757, [880, 882], 471],
								[-3.599999, 10.973024, [881, 883], 472],
								[-3.599999, 11.001290, [882, 884], 473],
								[-3.599999, 11.029556, [883, 885], 474],
								[-3.600000, 11.057822, [884, 886], 475],
								[-3.599999, 11.086087, [885, 887], 476],
								[-3.599999, 11.114353, [886, 888], 477],
								[-3.599999, 11.142619, [887, 889], 478],
								[-3.599999, 11.170886, [888, 890], 479],
								[-3.599999, 11.199150, [889, 891], 480],
								[-3.599999, 11.227417, [890, 892], 481],
								[-3.599999, 11.255683, [891, 893], 482],
								[-3.599999, 11.283949, [892, 894], 483],
								[-3.599999, 11.312215, [893, 895], 484],
								[-3.599999, 11.340480, [894, 896], 485],
								[-3.599999, 11.368746, [895, 897], 486],
								[-3.599999, 11.397013, [896, 898], 487],
								[-3.599999, 11.425279, [897, 899], 488],
								[-3.599999, 11.453544, [898, 900], 489],
								[-3.599999, 11.481810, [899, 901], 490],
								[-3.599999, 11.510076, [900, 902], 491],
								[-3.599999, 11.538342, [901, 903], 492],
								[-3.599999, 11.566607, [902, 904], 493],
								[-3.599999, 11.594872, [903, 905], 494],
								[-3.599999, 11.623138, [904, 906], 495],
								[-3.600000, 11.651405, [905, 907], 496],
								[-3.599999, 11.679671, [906, 908], 497],
								[-3.599999, 11.707936, [907, 909], 498],
								[-3.599999, 11.736201, [908, 910], 499],
								[-3.599999, 11.764468, [909], 500],
							];
							
		// keep track of current node index
		let currentIndex = 0;
		// at topâlevel, before setting up listeners:
		const keyState = { KeyW: true, KeyA: false, KeyS: false, KeyD: false };
	
    import * as THREE from 'three';
    import { PointerLockControls } from 'PointerLockControls';
    import { KTX2Loader } from 'KTX2Loader';
		import JSZip from "jszip";

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000);
    camera.position.set(0, 0, 0);

    const controls = new PointerLockControls(camera, document.body);
    scene.add(controls.getObject());

    let sphere;

    const ktx2Loader = new KTX2Loader()
      .setTranscoderPath('./basis/')
      .detectSupport(renderer);
			
		const NUM_IMAGES = 911;
		const textureCache = {};

		fetch("textures.zip")
		.then(r => r.arrayBuffer())
		.then(buf => JSZip.loadAsync(buf))
		.then(zip => {
			const folder = zip.folder("textures");
			const promises = [];

			folder.forEach((relPath, entry) => {
				const idx = parseInt(relPath, 10);
				promises.push(
					entry.async("arraybuffer")
						// fallback to loader.loadAsync so you get all the builtâin bits:
						.then(ab => {
							const blob = new Blob([ab]);
							const url  = URL.createObjectURL(blob);
							return ktx2Loader.loadAsync(url)
								.finally(() => URL.revokeObjectURL(url));
						})
						.then(tex => {
							tex.generateMipmaps = false;
							tex.needsUpdate     = true;
							textureCache[idx]   = tex;
							renderer.initTexture(tex); // <-- forces createTexture + upload now. This is huge. Forces texture creation now instead of lazily, like three.js normally does it.
						})
				);
			});

			return Promise.all(promises);
		})
		.then(() => {
			console.log("ALL DONE â textures in cache!");
			setupSphere();
			animate();
		})
		.catch(err => console.error("ZIPâKTX2 error:", err));
			
			
			

    function setupSphere() {
      const geometry = new THREE.SphereGeometry(500, 600, 400); // 500 radius, 600 vert lines, 400 horiz lines
      geometry.scale(-1, 1, 1); // Invert the sphere to face inward

      const material = new THREE.MeshBasicMaterial({ map: textureCache[0] });
      sphere = new THREE.Mesh(geometry, material);
      scene.add(sphere);
    }

    // in your animate loop:
		let throttler = 0;
		function animate() {
		
		
			requestAnimationFrame(animate);

			// 1) handle movement:
			const dir = new THREE.Vector3();
			camera.getWorldDirection(dir);    // local forward
			const up = new THREE.Vector3(0,1,0);

			// build a strafing/right vector too:
			const right = dir.clone().applyAxisAngle(up, -Math.PI/2);

			// accumulate
			const move = new THREE.Vector3();
			if (keyState.KeyW) move.add(dir);
			if (keyState.KeyS) move.sub(dir);
			if (keyState.KeyA) move.sub(right);
			if (keyState.KeyD) move.add(right);

			throttler = (throttler + 1) % 2;
			if (move.lengthSq() > 1e-6 && throttler === 0) {
				[move.x, move.y, move.z] = [-move.z, -move.x, move.y];
				console.log(move);

				moveAlongNodes(move);
			}

			renderer.render(scene, camera);
		}

    window.addEventListener('resize', () => {
      renderer.setSize(innerWidth, innerHeight);
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
    });

    // Enable look-around on click
		let context;
    document.getElementById('overlay').addEventListener('click', () => {
      document.getElementById('overlay').style.display = 'none';
      controls.lock();
			
			if (!context) {
				context = new (window.AudioContext || window.webkitAudioContext)();
			}
			context.resume(); // necessary to "unlock" audio in many browsers
			preloadAllSounds();
			
    });

		// helper: given a worldâspace direction Vec3, snap to best neighbor
		function moveAlongNodes(directionVec) {
			// project to 2D (weâll ignore Z)
			const dir2 = new THREE.Vector2(directionVec.x, directionVec.y).normalize();

			let bestDot = -Infinity;
			let bestIdx = currentIndex;

			const [x0, y0] = node_arr[currentIndex];
			const origin2 = new THREE.Vector2(x0, y0);

			// for each connected nodeâ¦
			for (const idx of node_arr[currentIndex][2]) {
				const [xn, yn] = node_arr[idx];
				const toNeighbor = new THREE.Vector2(xn, yn).sub(origin2).normalize();
				const dot = dir2.dot(toNeighbor);
				if (dot > bestDot && dot > 0.0) {
					bestDot = dot;
					bestIdx = idx;
				}
			}

			// if we actually found a different neighbor, jump there
			if (bestIdx !== currentIndex) {
				currentIndex = bestIdx;
				sphere.material.map = textureCache[currentIndex];
				sphere.material.needsUpdate = true;
				console.log(currentIndex);
				
				// sound
				const src = context.createBufferSource();
				src.buffer = audioBuffers[0]; // should be next!!!
				src.connect(context.destination);
					
				console.log(node_arr[currentIndex][3]);
				playNodeSound(0, node_arr[currentIndex][3]);
				
			}
		}

		window.addEventListener('keydown', (e) => {
			if (e.code in keyState) {
				keyState[e.code] = true;
				e.preventDefault();
			}
		});
		window.addEventListener('keyup', (e) => {
			if (e.code in keyState) {
				keyState[e.code] = false;
				e.preventDefault();
			}
		});

		
  </script>
</body>
</html>
